EESchema Schematic File Version 2
LIBS:Trainiot
LIBS:power
LIBS:device
LIBS:transistors
LIBS:conn
LIBS:linear
LIBS:regul
LIBS:74xx
LIBS:cmos4000
LIBS:adc-dac
LIBS:memory
LIBS:xilinx
LIBS:microcontrollers
LIBS:dsp
LIBS:microchip
LIBS:analog_switches
LIBS:motorola
LIBS:texas
LIBS:intel
LIBS:audio
LIBS:interface
LIBS:digital-audio
LIBS:philips
LIBS:display
LIBS:cypress
LIBS:siliconi
LIBS:opto
LIBS:atmel
LIBS:contrib
LIBS:valves
LIBS:SpiDcc-cache
EELAYER 25 0
EELAYER END
$Descr A4 11693 8268
encoding utf-8
Sheet 5 9
Title "Trainiot SPI DCC"
Date "2017-04-26"
Rev "1.4"
Comp "Lars MÃ¸llebjerg"
Comment1 ""
Comment2 ""
Comment3 ""
Comment4 "Buffers the command received from SPI."
$EndDescr
Text HLabel 1300 1400 0    60   Input ~ 0
DCC
Text HLabel 1300 1550 0    60   Input ~ 0
~IN_DATA_BIT~
Text HLabel 1300 1700 0    60   Input ~ 0
~IN_CMD_END_BIT~
Text HLabel 1300 1850 0    60   Input ~ 0
SCLK
Text HLabel 1300 2150 0    60   Input ~ 0
MOSI
Text HLabel 1300 2000 0    60   Input ~ 0
~SS~
Text HLabel 9700 2350 2    60   Output ~ 0
COMMAND_VALID
Text HLabel 9700 1700 2    60   Output ~ 0
COMMAND_DATA
$Comp
L C C503
U 1 1 58B91906
P 8000 1150
F 0 "C503" H 8025 1250 50  0000 L CNN
F 1 "100nf" H 8025 1050 50  0000 L CNN
F 2 "Capacitors_SMD:C_0603" H 8038 1000 50  0001 C CNN
F 3 "" H 8000 1150 50  0000 C CNN
	1    8000 1150
	0    1    1    0   
$EndComp
$Comp
L VCC #PWR026
U 1 1 58B9190C
P 7750 1050
F 0 "#PWR026" H 7750 900 50  0001 C CNN
F 1 "VCC" H 7750 1200 50  0000 C CNN
F 2 "" H 7750 1050 50  0000 C CNN
F 3 "" H 7750 1050 50  0000 C CNN
	1    7750 1050
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR027
U 1 1 58B91915
P 8250 1200
F 0 "#PWR027" H 8250 950 50  0001 C CNN
F 1 "GND" H 8250 1050 50  0000 C CNN
F 2 "" H 8250 1200 50  0000 C CNN
F 3 "" H 8250 1200 50  0000 C CNN
	1    8250 1200
	1    0    0    -1  
$EndComp
$Comp
L 74HC153 U503
U 1 1 58BA275F
P 8100 2200
F 0 "U503" H 8100 2500 50  0000 C CNN
F 1 "74HC153" H 8100 2350 50  0000 C CNN
F 2 "SMD_Packages:SO-16-N" H 8100 2200 50  0001 C CNN
F 3 "" H 8100 2200 50  0000 C CNN
	1    8100 2200
	1    0    0    -1  
$EndComp
$Sheet
S 3100 1300 1550 1000
U 58BAAADE
F0 "ShiftRegisters" 60
F1 "ShiftRegisters.sch" 60
F2 "DCC" I L 3100 1400 60 
F3 "~IN_DATA_BIT~" I L 3100 1550 60 
F4 "3_BYTE_CMD" O R 4650 1400 60 
F5 "4_BYTE_CMD" O R 4650 1500 60 
F6 "5_BYTE_CMD" O R 4650 1600 60 
F7 "6_BYTE_CMD" O R 4650 1700 60 
F8 "~IN_CMD_END_BIT~" I L 3100 1700 60 
F9 "SCLK" I L 3100 1850 60 
F10 "~SS~" I L 3100 2000 60 
F11 "MOSI" I L 3100 2150 60 
$EndSheet
Text HLabel 9700 3250 2    60   Output ~ 0
CMD_LENGTH_BIT_0
Text HLabel 9700 3350 2    60   Output ~ 0
CMD_LENGTH_BIT_1
Text HLabel 9700 3450 2    60   Output ~ 0
CMD_LENGTH_BIT_2
$Comp
L 74HC75 U502
U 1 1 58BB558B
P 5200 3150
F 0 "U502" H 5200 3250 50  0000 C CNN
F 1 "74HC75" H 5200 3050 50  0000 C CNN
F 2 "SMD_Packages:SO-16-N" H 5200 3150 50  0001 C CNN
F 3 "" H 5200 3150 50  0000 C CNN
	1    5200 3150
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR028
U 1 1 58BB55A3
P 4900 3750
F 0 "#PWR028" H 4900 3500 50  0001 C CNN
F 1 "GND" H 4900 3600 50  0000 C CNN
F 2 "" H 4900 3750 50  0000 C CNN
F 3 "" H 4900 3750 50  0000 C CNN
	1    4900 3750
	1    0    0    -1  
$EndComp
$Comp
L C C502
U 1 1 58BB6967
P 5150 2450
F 0 "C502" H 5175 2550 50  0000 L CNN
F 1 "100nf" H 5175 2350 50  0000 L CNN
F 2 "Capacitors_SMD:C_0603" H 5188 2300 50  0001 C CNN
F 3 "" H 5150 2450 50  0000 C CNN
	1    5150 2450
	0    1    1    0   
$EndComp
$Comp
L VCC #PWR029
U 1 1 58BB696D
P 4900 2350
F 0 "#PWR029" H 4900 2200 50  0001 C CNN
F 1 "VCC" H 4900 2500 50  0000 C CNN
F 2 "" H 4900 2350 50  0000 C CNN
F 3 "" H 4900 2350 50  0000 C CNN
	1    4900 2350
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR030
U 1 1 58BB6973
P 5400 2500
F 0 "#PWR030" H 5400 2250 50  0001 C CNN
F 1 "GND" H 5400 2350 50  0000 C CNN
F 2 "" H 5400 2500 50  0000 C CNN
F 3 "" H 5400 2500 50  0000 C CNN
	1    5400 2500
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR031
U 1 1 58BB6B74
P 7050 1950
F 0 "#PWR031" H 7050 1700 50  0001 C CNN
F 1 "GND" H 7050 1800 50  0000 C CNN
F 2 "" H 7050 1950 50  0000 C CNN
F 3 "" H 7050 1950 50  0000 C CNN
	1    7050 1950
	0    1    1    0   
$EndComp
$Comp
L GND #PWR032
U 1 1 58BC04BB
P 7750 3050
F 0 "#PWR032" H 7750 2800 50  0001 C CNN
F 1 "GND" H 7750 2900 50  0000 C CNN
F 2 "" H 7750 3050 50  0000 C CNN
F 3 "" H 7750 3050 50  0000 C CNN
	1    7750 3050
	1    0    0    -1  
$EndComp
Text HLabel 1300 2300 0    60   Input ~ 0
IN_CMD_END_BIT
$Comp
L 74HC590 U501
U 1 1 58BEA331
P 2900 5300
F 0 "U501" H 3050 5900 50  0000 C CNN
F 1 "74HC590" H 2900 4700 50  0000 C CNN
F 2 "SMD_Packages:SO-16-N" H 2900 5300 50  0001 C CNN
F 3 "" H 2900 5300 50  0000 C CNN
	1    2900 5300
	1    0    0    -1  
$EndComp
$Comp
L 74HC04 U402
U 5 1 58BEAE7C
P 1700 4200
F 0 "U402" H 1850 4300 50  0000 C CNN
F 1 "74HC04" H 1900 4100 50  0000 C CNN
F 2 "SMD_Packages:SOIC-14_N" H 1700 4200 50  0001 C CNN
F 3 "" H 1700 4200 50  0000 C CNN
	5    1700 4200
	0    1    1    0   
$EndComp
$Comp
L 74HC04 U402
U 6 1 58BEB12B
P 2950 6550
F 0 "U402" H 3100 6650 50  0000 C CNN
F 1 "74HC04" H 3150 6450 50  0000 C CNN
F 2 "SMD_Packages:SOIC-14_N" H 2950 6550 50  0001 C CNN
F 3 "" H 2950 6550 50  0000 C CNN
	6    2950 6550
	-1   0    0    1   
$EndComp
$Comp
L 74HC32 U302
U 4 1 58BEB299
P 6100 5500
F 0 "U302" H 6100 5550 50  0000 C CNN
F 1 "74HC32" H 6100 5450 50  0000 C CNN
F 2 "SMD_Packages:SOIC-14_N" H 6100 5500 50  0001 C CNN
F 3 "" H 6100 5500 50  0000 C CNN
	4    6100 5500
	1    0    0    -1  
$EndComp
$Comp
L C C501
U 1 1 58BF9639
P 2850 4400
F 0 "C501" H 2875 4500 50  0000 L CNN
F 1 "100nf" H 2875 4300 50  0000 L CNN
F 2 "Capacitors_SMD:C_0603" H 2888 4250 50  0001 C CNN
F 3 "" H 2850 4400 50  0000 C CNN
	1    2850 4400
	0    1    1    0   
$EndComp
$Comp
L VCC #PWR033
U 1 1 58BF963F
P 2600 4300
F 0 "#PWR033" H 2600 4150 50  0001 C CNN
F 1 "VCC" H 2600 4450 50  0000 C CNN
F 2 "" H 2600 4300 50  0000 C CNN
F 3 "" H 2600 4300 50  0000 C CNN
	1    2600 4300
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR034
U 1 1 58BF9645
P 3100 4450
F 0 "#PWR034" H 3100 4200 50  0001 C CNN
F 1 "GND" H 3100 4300 50  0000 C CNN
F 2 "" H 3100 4450 50  0000 C CNN
F 3 "" H 3100 4450 50  0000 C CNN
	1    3100 4450
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR035
U 1 1 58BF9771
P 2600 6000
F 0 "#PWR035" H 2600 5750 50  0001 C CNN
F 1 "GND" H 2600 5850 50  0000 C CNN
F 2 "" H 2600 6000 50  0000 C CNN
F 3 "" H 2600 6000 50  0000 C CNN
	1    2600 6000
	1    0    0    -1  
$EndComp
$Comp
L R R501
U 1 1 58BFA1F0
P 1600 1050
F 0 "R501" V 1680 1050 50  0000 C CNN
F 1 "10K" V 1600 1050 50  0000 C CNN
F 2 "Resistors_SMD:R_0603" V 1530 1050 50  0001 C CNN
F 3 "" H 1600 1050 50  0000 C CNN
	1    1600 1050
	-1   0    0    1   
$EndComp
$Comp
L VCC #PWR036
U 1 1 58BFA428
P 1600 800
F 0 "#PWR036" H 1600 650 50  0001 C CNN
F 1 "VCC" H 1600 950 50  0000 C CNN
F 2 "" H 1600 800 50  0000 C CNN
F 3 "" H 1600 800 50  0000 C CNN
	1    1600 800 
	1    0    0    -1  
$EndComp
Wire Wire Line
	6800 4100 6800 5500
Wire Wire Line
	2000 6550 2500 6550
Wire Wire Line
	1700 3600 2000 3600
Wire Wire Line
	1600 900  1600 800 
Connection ~ 1600 2000
Wire Wire Line
	1600 1200 1600 2000
Connection ~ 2600 5900
Wire Wire Line
	2150 5900 2600 5900
Wire Wire Line
	2150 5450 2150 5900
Wire Wire Line
	2200 5450 2150 5450
Wire Wire Line
	2600 5850 2600 6000
Connection ~ 2600 4400
Wire Wire Line
	2600 4400 2700 4400
Wire Wire Line
	3100 4400 3100 4450
Wire Wire Line
	3000 4400 3100 4400
Wire Wire Line
	2600 4300 2600 4750
Wire Wire Line
	2000 5150 2200 5150
Wire Wire Line
	2000 5150 2000 6550
Connection ~ 2000 3600
Wire Wire Line
	1700 3750 1700 3600
Wire Wire Line
	6800 5500 6700 5500
Wire Wire Line
	4200 3100 4500 3100
Wire Wire Line
	4200 4100 4200 3100
Wire Wire Line
	6800 4100 4200 4100
Wire Wire Line
	4100 3000 4500 3000
Wire Wire Line
	4100 5350 4100 3000
Wire Wire Line
	3600 5350 4100 5350
Wire Wire Line
	4000 2900 4500 2900
Wire Wire Line
	4000 5250 4000 2900
Wire Wire Line
	3600 5250 4000 5250
Wire Wire Line
	3900 2800 4500 2800
Wire Wire Line
	3900 5150 3900 2800
Wire Wire Line
	3600 5150 3900 5150
Wire Wire Line
	4200 5600 5500 5600
Wire Wire Line
	4200 5550 4200 5600
Wire Wire Line
	3600 5550 4200 5550
Wire Wire Line
	4200 5400 5500 5400
Wire Wire Line
	4200 5450 4200 5400
Wire Wire Line
	3600 5450 4200 5450
Wire Wire Line
	3700 6550 3400 6550
Wire Wire Line
	3700 5750 3700 6550
Wire Wire Line
	3600 5750 3700 5750
Wire Wire Line
	2000 2000 2000 4850
Wire Wire Line
	1700 4650 1700 5350
Connection ~ 2100 1850
Wire Wire Line
	2100 4950 2100 1850
Wire Wire Line
	2200 4950 2100 4950
Wire Wire Line
	1700 5350 2200 5350
Wire Wire Line
	2000 4850 2200 4850
Connection ~ 2000 2000
Wire Wire Line
	2950 2300 2950 3350
Wire Wire Line
	1300 2300 2950 2300
Wire Wire Line
	7750 2950 7750 3050
Connection ~ 6700 3200
Wire Wire Line
	7050 3450 9700 3450
Wire Wire Line
	7050 3200 7050 3450
Connection ~ 7150 2900
Wire Wire Line
	7150 3350 9700 3350
Wire Wire Line
	7150 2900 7150 3350
Connection ~ 7250 2800
Wire Wire Line
	7250 3250 7250 2800
Wire Wire Line
	9700 3250 7250 3250
Connection ~ 7250 2250
Wire Wire Line
	7350 2150 7250 2150
Connection ~ 7250 2350
Wire Wire Line
	7250 2250 7350 2250
Wire Wire Line
	7250 2150 7250 2350
Wire Wire Line
	6700 2350 7350 2350
Wire Wire Line
	6700 3200 6700 2350
Wire Wire Line
	6800 2450 6800 3300
Wire Wire Line
	7350 2450 6800 2450
Wire Wire Line
	6900 2600 7350 2600
Wire Wire Line
	6900 3400 6900 2600
Wire Wire Line
	7350 1950 7050 1950
Connection ~ 4900 2450
Wire Wire Line
	4900 2450 5000 2450
Wire Wire Line
	5400 2450 5400 2500
Wire Wire Line
	5300 2450 5400 2450
Wire Wire Line
	4900 2350 4900 2750
Wire Wire Line
	6600 2900 7350 2900
Wire Wire Line
	6600 3000 6600 2900
Connection ~ 7750 1150
Wire Wire Line
	7750 1150 7850 1150
Wire Wire Line
	8250 1150 8250 1200
Wire Wire Line
	8150 1150 8250 1150
Wire Wire Line
	7750 1050 7750 1450
Connection ~ 4350 3350
Wire Wire Line
	4350 3400 4500 3400
Wire Wire Line
	4350 3300 4500 3300
Wire Wire Line
	4350 3300 4350 3400
Wire Wire Line
	2950 3350 4350 3350
Wire Wire Line
	5900 3400 6900 3400
Wire Wire Line
	5900 3200 7050 3200
Wire Wire Line
	5900 3000 6600 3000
Wire Wire Line
	4900 3550 4900 3750
Wire Wire Line
	5900 2800 7350 2800
Wire Wire Line
	1300 1850 3100 1850
Wire Wire Line
	1300 2000 3100 2000
Wire Wire Line
	1300 2150 3100 2150
Wire Wire Line
	1300 1700 3100 1700
Wire Wire Line
	1300 1550 3100 1550
Wire Wire Line
	1300 1400 3100 1400
Wire Wire Line
	7100 1400 7100 1800
Wire Wire Line
	4650 1400 7100 1400
Wire Wire Line
	4650 1700 7350 1700
Wire Wire Line
	4650 1600 7350 1600
Wire Wire Line
	4650 1500 7350 1500
Wire Wire Line
	7100 1800 7350 1800
Wire Wire Line
	8850 1700 9700 1700
Wire Wire Line
	8850 2350 9700 2350
Wire Wire Line
	6800 3300 5900 3300
NoConn ~ 5900 2900
NoConn ~ 5900 3100
NoConn ~ 5900 3500
NoConn ~ 3600 4850
NoConn ~ 3600 4950
NoConn ~ 3600 5050
$EndSCHEMATC
